<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/static/css/movie-list.css"/>
    <link rel="stylesheet" type="text/css" href="/static/css/index.css">
    <link href="/static/plugin/layui/css/layui.css" rel="stylesheet">
</head>
<body>
<div th:replace="header::header"></div>
<div class="container" id="app" style="margin-top: 100px;">
    <div class="movies-channel layui-form">
        <div class="tags-panel">
            <ul class="tags-lines">
                <li class="tags-line">
                    <div class="tags-title">类型 :</div>
                    <ul class="tags" id="type">
                        <li class="active" name="type" value="all" id="typeAll">
                            <a onclick="filter('type', '全部', this)">全部</a>
                        </li>
                        <li>
                            <a onclick="filter('type', '喜剧片', this)">喜剧片</a>
                        </li>
                        <li>
                            <a onclick="filter('type', '动作片', this)">动作片</a>
                        </li>
                        <li>
                            <a onclick="filter('type', '剧情片', this)">剧情片</a>
                        </li>
                        <li>
                            <a onclick="filter('type', '战争片', this)">战争片</a>
                        </li>
                        <li>
                            <a onclick="filter('type', '爱情片', this)">爱情片</a>
                        </li>
                        <li>
                            <a onclick="filter('type', '科幻片', this)">科幻片</a>
                        </li>
                        <li>
                            <a onclick="filter('type', '恐怖片', this)">恐怖片</a>
                        </li>
                    </ul>
                </li>
                <li class="tags-line tags-line-border">
                    <div class="tags-title">题材 :</div>
                    <ul class="tags" id="genre">
                        <li class="active" id="genreAll">
                            <a onclick="filter('genre', '全部', this)">全部</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '爱情', this)">爱情</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '喜剧', this)">喜剧</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '剧情', this)">剧情</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '恐怖', this)">恐怖</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '惊悚', this)">惊悚</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '科幻', this)">科幻</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '动作', this)">动作</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '冒险', this)">冒险</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '战争', this)">战争</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '奇幻', this)">奇幻</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '运动', this)">运动</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '家庭', this)">家庭</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '古装', this)">古装</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '武侠', this)">武侠</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '西部', this)">西部</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '历史', this)">历史</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '传记', this)">传记</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '歌舞', this)">歌舞</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '黑色电影', this)">黑色电影</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '短片', this)">短片</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '纪录片', this)">纪录片</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '戏曲', this)">戏曲</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '音乐', this)">音乐</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '灾难', this)">灾难</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '青春', this)">青春</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '儿童', this)">儿童</a>
                        </li>
                        <li>
                            <a onclick="filter('genre', '其他', this)">其他</a>
                        </li>
                    </ul>
                </li>
                <li class="tags-line tags-line-border">
                    <div class="tags-title">区域 :</div>
                    <ul class="tags" id="region">
                        <li class="active" id="regionAll">
                            <a onclick="filter('region', '全部', this)">全部</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '大陆', this)">大陆</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '美国', this)">美国</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '韩国', this)">韩国</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '日本', this)">日本</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '中国香港', this)">中国香港</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '中国澳门', this)">中国澳门</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '中国台湾', this)">中国台湾</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '泰国', this)">泰国</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '印度', this)">印度</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '法国', this)">法国</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '英国', this)">英国</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '俄罗斯', this)">俄罗斯</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '意大利', this)">意大利</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '西班牙', this)">西班牙</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '德国', this)">德国</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '波兰', this)">波兰</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '澳大利亚', this)">澳大利亚</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '伊朗', this)">伊朗</a>
                        </li>
                        <li>
                            <a onclick="filter('region', '其他', this)">其他</a>
                        </li>
                    </ul>
                </li>
                <li class="tags-line tags-line-border">
                    <div class="tags-title">年代 :</div>
                    <ul class="tags" id="year">
                        <li class="active" name="year" value="all" id="yearAll">
                            <a onclick="filter('year', '全部', this)">全部</a>
                        </li>
                        <li name="year" value="2024">
                            <a onclick="filter('year', '2024', this)">2024</a>
                        </li>
                        <li name="year" value="2023">
                            <a onclick="filter('year', '2023', this)">2023</a>
                        </li>
                        <li name="year" value="2022">
                            <a onclick="filter('year', '2022', this)">2022</a>
                        </li>
                        <li name="year" value="2021">
                            <a onclick="filter('year', '2021', this)">2021</a>
                        </li>
                        <li name="year" value="2020">
                            <a onclick="filter('year', '2020', this)">2020</a>
                        </li>
                        <li name="year" value="2019">
                            <a onclick="filter('year', '2019', this)">2019</a>
                        </li>
                        <li name="year" value="2018">
                            <a onclick="filter('year', '2018', this)">2018</a>
                        </li>
                        <li name="year" value="2017">
                            <a onclick="filter('year', '2017', this)">2017</a>
                        </li>
                        <li name="year" value="2016">
                            <a onclick="filter('year', '2016', this)">2016</a>
                        </li>
                        <li name="year" value="2015">
                            <a onclick="filter('year', '2015', this)">2015</a>
                        </li>
                        <li name="year" value="2014">
                            <a onclick="filter('year', '2014', this)">2014</a>
                        </li>
                        <li name="year" value="2013">
                            <a onclick="filter('year', '2013', this)">2013</a>
                        </li>
                        <li name="year" value="2012">
                            <a onclick="filter('year', '2012', this)">2012</a>
                        </li>
                        <li name="year" value="2011">
                            <a onclick="filter('year', '2011', this)">2011</a>
                        </li>
                        <li name="year" value="2010">
                            <a onclick="filter('year', '2010', this)">2010</a>
                        </li>
                        <li name="year" value="2009">
                            <a onclick="filter('year', '2009', this)">2009</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="movies-list">
            <dl class="movie-list">
                <dd th:each="movie : ${moviePage.records}">
                    <div class="movie-item film-channel">
                        <a th:href="@{/page/movie/detail/{mid}(mid=${movie.mid})}" target="_blank">
                            <div class="movie-poster">
                                <img class="poster-default" th:src="@{/static/image/{image}(image=${movie.image})}"/>
                            </div>
                        </a>
                    </div>
                    <div class="channel-detail movie-item-title" th:title="${movie.title}">
                        <a th:href="@{/page/movie/detail/{mid}(mid=${movie.mid})}" target="_blank"
                           th:text="${movie.title}"></a>
                    </div>
                    <div class="channel-detail channel-detail-orange"><i class="integer" th:text="${movie.rating}"></i>
                    </div>
                </dd>
            </dl>
        </div>
        <div id="page" style="text-align: center;"></div>
    </div>
</div>
<div th:replace="footer::footer"></div>
</body>
<script type="text/javascript" src="/static/js/main.js"></script>
<script type="text/javascript" src="/static/js/slidey.js"></script>
<script type="text/javascript" src="/static/plugin/layui/layui.js"></script>
<script type="text/javascript" src="/static/plugin/jquery/jquery-3.7.1.js"></script>
<script th:inline="javascript">
    var total = [[${moviePage.total}]];
    var curr = [[${moviePage.current}]];
    var size = [[${moviePage.size}]];
    var obj = [[${obj}]]
</script>
<script type="text/javascript">
    $(document).ready(function(){
        initPublic();


        $('#type').children().each(function () {
            if ($(this).children()[0].innerText === obj['type']) {
                $('#typeAll').removeClass('active');
                $(this).addClass('active');
            }
        })

        $('#genre').children().each(function () {
            if ($(this).children()[0].innerText === obj['genre']) {
                $('#genreAll').removeClass('active');
                $(this).addClass('active');
            }
        })

        $('#region').children().each(function () {
            if ($(this).children()[0].innerText === obj['region']) {
                $('#regionAll').removeClass('active');
                $(this).addClass('active');
            }
        })

        $('#year').children().each(function () {
            if ($(this).children()[0].innerText === obj['year']) {
                $('#yearAll').removeClass('active');
                $(this).addClass('active');
            }
        })
    });

    function filter(key, value, that) {
        obj[key] = value;
        var base = "?pageNo=1&pageSize=" + size;
        var path = "";
        for (k in obj) {
            if (obj[k] !== "全部") {
                path = path + "&" + k + "=" + obj[k];
            }
        }

        $(that).parent().addClass('active');
        // 遍历父元素的所有兄弟元素
        $(that).parent().siblings().each(function () {
            // 查找兄弟元素下的具有 active 类的子元素并移除该类
            if ($(this).hasClass('active')) {
                $(this).removeClass('active');
            }
        });

        window.location.href = "/page/movie" + base + path;
    }


    layui.use(function () {
        var util = layui.util;
        var laypage = layui.laypage;
        // 完整显示
        laypage.render({
            elem: 'page', // 元素 id
            curr: curr, // 当前页码
            count: total, // 数据总数
            limit: size, // 每页条数
            theme: '#FFB800', // 主题
            layout: ['count', 'prev', 'page', 'next', 'limit', 'skip'], // 功能布局
            limits: [12, 24, 36, 48],
            jump: function (object, first) {
                if (!first) {
                    var path = "";
                    for (k in obj) {
                        if (obj[k] !== "全部") {
                            path = path + "&" + k + "=" + obj[k];
                        }
                    }
                    window.location.href = '/page/movie?pageNo=' + object.curr + '&pageSize=' + object.limit + path;
                }
            }
        });
    });
</script>
</html>
